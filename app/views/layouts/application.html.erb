<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Let's E-Chat</title>
    <%= csrf_meta_tags %>
    <%= stylesheet_link_tag    'application', media: 'all' %>
    <%= javascript_include_tag 'application' %>
    <%= action_cable_meta_tag %>
    <link href='/assets/logo.png' rel='shortcut icon' type='image/x-icon'>

  <!-- <script src=""></script> -->
  </head>
  <body>
    <div class="notify_btn_sec"></div>
  <nav class="navbar navbar-inverse ">
    <div class="container-fluid">
      <div class="navbar-header">
        <a class="navbar-brand" href="/" style="padding-top: 10px;"><img src="/assets/logo.png" height="35px" style="display: inline-block;margin-right: 5px;"><span>Let's E-Chat</span></a>
      </div>
<!--      <ul class="nav navbar-nav">
        <li class="active"><a href="/">Home</a></li>
      </ul> -->
 
      <ul class="nav navbar-nav navbar-right">
        

        <% if user_signed_in? %>
          <li>
            <div class="dropdown">
              <a href="javascript:void(0)" class="dropdown-toggle" data-toggle="dropdown">
                <img src="/assets/profile_icon.png" alt="Profile" class="profile-img">
              </a>
              <ul class="dropdown-menu">
                <li><a href="javascript:void(0)"><%= current_user.email %></a></li>
                <li class="divider"></li>
                <li><%= link_to(destroy_user_session_path, method: :delete) do %>
                  <span class="glyphicon glyphicon-log-in"></span>
                  LogOut
                  <%end%> 
                </li>
              </ul>
            </div>
          </li>
        <% else %>
          <li>
            <%= link_to(new_user_session_path) do  %>
              <span class="glyphicon glyphicon-log-in"></span>
              Login
            <%end%>        
          </li>
        <% end %>
      </ul>
    </div>
  </nav>
    <div class="container">
      <%= bootstrap_flash %>
      <%= yield %>
    </div>
  </body>
  <script type="text/javascript">
    $(".alert").fadeOut(5000);
    // if(!(Notification.permission === "granted")){
    //   $(".notify_btn_sec").html("<button onclick='notifyMe()' class='notify_btn'>Notify me!</button>");
    // }
    function notifyMe() {
      if (!("Notification" in window)) {
        alert("This browser does not support desktop notification");
      }
      else if (Notification.permission === "granted") {
            var options = {
                    body: "Now you will get the notification from Let's E-Chart",
                    icon: "/assets/logo.png",
                    dir : "ltr"
                 };
              var notification = new Notification("Hi there",options);
              $(".notify_btn").hide();
      }
      else if (Notification.permission !== 'denied') {
        Notification.requestPermission(function (permission) {
          if (!('permission' in Notification)) {
            Notification.permission = permission;
          }
        
          if (permission === "granted") {
            var options = {
                  body: "Now you will get the notification from Let's E-Chart",
                  icon: "/assets/logo.png",
                  dir : "ltr"
              };
            var notification = new Notification("Hi there",options);
            $(".notify_btn").hide();
          }
        });
      }
    }
  </script>
</html>